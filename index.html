<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <title>Koala OS 2025 Â· ç‘„æŸ”å°ˆå±¬å®‡å®™</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="theme-color" content="#2e7d32">
    
    <!-- å¼•å…¥å¤šç¨®é«˜ç´šå­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;600&family=Zen+Maru+Gothic:wght@500;900&family=Nunito:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* =========================================
           1. SYSTEM VARIABLES (KOALA PALETTE)
        ========================================= */
        :root {
            --primary: #558b2f;       /* å°¤åŠ åˆ©è‘‰æ·±ç¶  */
            --secondary: #aed581;     /* å«©èŠ½ç¶  */
            --accent: #ff8a65;        /* æº«æš–æ©˜ (ç„¡å°¾ç†Šé¼»å­/å¤•é™½) */
            --bg-dark: #1b5e20;       /* æ£®æ—æ·±è™• */
            --bg-light: #f1f8e9;
            --glass: rgba(255, 255, 255, 0.85);
            --glass-dark: rgba(0, 0, 0, 0.6);
            --shadow-lg: 0 20px 50px rgba(0,0,0,0.2);
            --bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            font-family: 'Zen Maru Gothic', sans-serif;
            overflow-x: hidden;
            color: #33691e;
            min-height: 100vh;
        }

        /* =========================================
           2. LOADING SYSTEM
        ========================================= */
        #sys-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: transform 1s cubic-bezier(0.7, 0, 0.3, 1);
        }
        .loader-circle {
            width: 80px; height: 80px; border: 5px solid rgba(255,255,255,0.2);
            border-top: 5px solid var(--secondary); border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .loader-text {
            margin-top: 20px; color: white; font-family: 'Fredoka'; letter-spacing: 2px;
            animation: pulse 1s infinite;
        }

        /* =========================================
           3. UI ARCHITECTURE (APP DOCK)
        ========================================= */
        .app-container {
            max-width: 1200px; margin: 0 auto; padding: 20px 20px 120px 20px;
            position: relative; z-index: 5;
        }

        /* åº•éƒ¨æ‡¸æµ® Dock */
        .dock-wrapper {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(255,255,255,0.4); backdrop-filter: blur(20px);
            padding: 15px 25px; border-radius: 30px;
            display: flex; gap: 20px; z-index: 1000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.5);
        }
        .dock-item {
            width: 50px; height: 50px; border-radius: 15px;
            background: white; display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; color: var(--primary); cursor: pointer;
            transition: 0.3s var(--bounce); position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .dock-item:hover { transform: translateY(-15px) scale(1.2); }
        .dock-item.active { background: var(--primary); color: white; }
        .dock-tooltip {
            position: absolute; top: -40px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 5px 10px;
            border-radius: 10px; font-size: 0.8rem; opacity: 0; pointer-events: none;
            transition: 0.2s; white-space: nowrap;
        }
        .dock-item:hover .dock-tooltip { opacity: 1; top: -50px; }

        /* =========================================
           4. TAMAGOTCHI ENGINE (é›»å­é›)
        ========================================= */
        .pet-card {
            background: var(--glass); border-radius: 40px; padding: 30px;
            text-align: center; position: relative; overflow: hidden;
            box-shadow: var(--shadow-lg); border: 3px solid white;
            margin-bottom: 40px;
        }
        .pet-stats {
            display: flex; justify-content: center; gap: 20px; margin-bottom: 20px;
        }
        .stat-bar {
            width: 100px; height: 10px; background: #ddd; border-radius: 10px; overflow: hidden;
            position: relative;
        }
        .stat-fill { height: 100%; width: 100%; transition: width 0.5s; }
        .fill-hunger { background: #ffca28; }
        .fill-happy { background: #ec407a; }
        
        /* ç„¡å°¾ç†Š SVG å‹•ç•«é¡åˆ¥ */
        .koala-svg { width: 200px; height: 200px; transition: 0.3s; cursor: pointer; }
        .koala-svg.eating { animation: eatAnim 0.5s infinite; }
        .koala-svg.happy { animation: jumpAnim 0.5s infinite; }
        .koala-svg.sleeping { filter: brightness(0.8); }

        @keyframes eatAnim { 0% { transform: scale(1); } 50% { transform: scale(1.05) rotate(5deg); } }
        @keyframes jumpAnim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        .pet-actions {
            display: flex; justify-content: center; gap: 15px; margin-top: 20px;
        }
        .action-btn {
            padding: 10px 20px; border-radius: 20px; border: none;
            background: var(--primary); color: white; font-weight: bold;
            cursor: pointer; transition: 0.2s; box-shadow: 0 5px 0 #33691e;
        }
        .action-btn:active { transform: translateY(5px); box-shadow: none; }

        /* =========================================
           5. 3D CUBE ENGINE
        ========================================= */
        .cube-scene {
            width: 200px; height: 200px; perspective: 600px; margin: 60px auto;
        }
        .cube {
            width: 100%; height: 100%; position: relative;
            transform-style: preserve-3d; transform: translateZ(-100px);
            animation: rotateCube 15s infinite linear;
        }
        .cube-face {
            position: absolute; width: 200px; height: 200px;
            border: 2px solid white; opacity: 0.9;
            background: rgba(255,255,255,0.9);
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; overflow: hidden;
        }
        .cube-face img { width: 100%; height: 100%; object-fit: cover; }
        
        .face-front  { transform: rotateY(  0deg) translateZ(100px); }
        .face-right  { transform: rotateY( 90deg) translateZ(100px); }
        .face-back   { transform: rotateY(180deg) translateZ(100px); }
        .face-left   { transform: rotateY(-90deg) translateZ(100px); }
        .face-top    { transform: rotateX( 90deg) translateZ(100px); }
        .face-bottom { transform: rotateX(-90deg) translateZ(100px); }

        @keyframes rotateCube {
            0% { transform: translateZ(-100px) rotateX(0deg) rotateY(0deg); }
            100% { transform: translateZ(-100px) rotateX(360deg) rotateY(360deg); }
        }

        /* =========================================
           6. GAME CANVAS & DRAWING BOARD
        ========================================= */
        .app-card {
            background: white; border-radius: 30px; padding: 20px;
            box-shadow: var(--shadow-lg); margin-bottom: 40px;
            display: none; /* é è¨­éš±è—ï¼Œé»æ“Š Dock åˆ‡æ› */
            animation: slideUp 0.5s var(--bounce);
        }
        .app-card.active { display: block; }

        canvas {
            background: #f0f0f0; border-radius: 20px; width: 100%;
            touch-action: none; cursor: crosshair;
        }

        @keyframes slideUp { from { opacity:0; transform:translateY(50px); } to { opacity:1; transform:translateY(0); } }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
<!-- 1. ç³»çµ±è¼‰å…¥ -->
<div id="sys-loader">
    <div class="loader-circle"></div>
    <div class="loader-text">KOALA OS STARTING...</div>
</div>

<!-- 2. èƒŒæ™¯æµæ˜Ÿé›¨ Canvas -->
<canvas id="star-canvas" style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none;"></canvas>

<!-- 3. ä¸»æ‡‰ç”¨å®¹å™¨ -->
<div class="app-container">

    <!-- Header -->
    <header style="text-align: center; margin-bottom: 40px; padding-top: 40px;">
        <div style="font-size: 1rem; color: var(--primary); font-weight: bold; letter-spacing: 2px;">WELCOME BACK</div>
        <h1 style="font-size: 3rem; color: var(--bg-dark); text-shadow: 2px 2px 0px white;">ç‘„æŸ”çš„å°ˆå±¬å®‡å®™</h1>
        
        <!-- æ™ºæ…§è¨ˆæ™‚å™¨ (2025-10-07) -->
        <div style="background: rgba(255,255,255,0.6); display: inline-block; padding: 10px 30px; border-radius: 50px; margin-top: 15px; font-weight: bold; color: #e91e63;">
            <i class="fas fa-heart"></i> <span id="main-timer">ç³»çµ±è¨ˆç®—ä¸­...</span>
        </div>
    </header>

    <!-- APP 1: KOALA TAMAGOTCHI (é›»å­é›) -->
    <div id="app-pet" class="app-card active">
        <h2 style="text-align:center; color:var(--primary); margin-bottom:20px;">ğŸ¨ å¦³çš„å°ˆå±¬ç„¡å°¾ç†Š</h2>
        
        <div class="pet-card">
            <!-- ç‹€æ…‹æ¢ -->
            <div class="pet-stats">
                <div>
                    <i class="fas fa-utensils" style="color:#ffca28"></i> é£½é£Ÿåº¦
                    <div class="stat-bar"><div class="stat-fill fill-hunger" id="bar-hunger" style="width: 80%;"></div></div>
                </div>
                <div>
                    <i class="fas fa-smile" style="color:#ec407a"></i> å¿ƒæƒ…å€¼
                    <div class="stat-bar"><div class="stat-fill fill-happy" id="bar-happy" style="width: 80%;"></div></div>
                </div>
            </div>

            <!-- ç„¡å°¾ç†Š SVG -->
            <div id="koala-pet" class="koala-svg">
                <svg viewBox="0 0 200 200">
                    <!-- Body -->
                    <ellipse cx="100" cy="140" rx="60" ry="50" fill="#9e9e9e"/>
                    <ellipse cx="100" cy="140" rx="30" ry="25" fill="#e0e0e0"/> <!-- Belly -->
                    
                    <!-- Head -->
                    <circle cx="100" cy="80" r="50" fill="#9e9e9e"/>
                    
                    <!-- Ears -->
                    <circle cx="55" cy="60" r="20" fill="#9e9e9e"/>
                    <circle cx="145" cy="60" r="20" fill="#9e9e9e"/>
                    <circle cx="55" cy="60" r="12" fill="#f5f5f5"/>
                    <circle cx="145" cy="60" r="12" fill="#f5f5f5"/>
                    
                    <!-- Face -->
                    <circle cx="85" cy="75" r="5" fill="#333" class="eye-left"/>
                    <circle cx="115" cy="75" r="5" fill="#333" class="eye-right"/>
                    <ellipse cx="100" cy="85" rx="12" ry="16" fill="#424242"/> <!-- Nose -->
                    <path d="M90 105 Q100 115 110 105" stroke="#333" stroke-width="3" fill="none" id="pet-mouth"/>
                    
                    <!-- Blush -->
                    <circle cx="70" cy="85" r="6" fill="rgba(255,100,100,0.3)"/>
                    <circle cx="130" cy="85" r="6" fill="rgba(255,100,100,0.3)"/>
                </svg>
            </div>

            <!-- å°è©±æ¡† -->
            <div id="pet-dialog" style="min-height: 30px; color: var(--primary); font-weight: bold; margin: 15px 0;">
                "ç‘„æŸ”ï½å¿«ä¾†é™ªæˆ‘ç©ï¼"
            </div>

            <!-- æ“ä½œæŒ‰éˆ• -->
            <div class="pet-actions">
                <button class="action-btn" onclick="feedPet()"><i class="fas fa-leaf"></i> é¤µé£Ÿ</button>
                <button class="action-btn" onclick="playPet()"><i class="fas fa-hand-sparkles"></i> æ‘¸æ‘¸</button>
                <button class="action-btn" onclick="sleepPet()"><i class="fas fa-bed"></i> ç¡è¦º</button>
            </div>
        </div>
    </div>
    <!-- APP 2: KOALA RUSH (éŠæˆ²) -->
    <div id="app-game" class="app-card">
        <h2 style="text-align:center; color:var(--primary); margin-bottom:10px;">ğŸ® Koala Catch</h2>
        <p style="text-align:center; color:#666; margin-bottom:20px;">é»æ“Šç•«é¢å·¦å³ç§»å‹•ï¼Œå¹«ç„¡å°¾ç†Šæ¥ä½æ„›å¿ƒï¼</p>
        
        <div style="position:relative; max-width:400px; margin:0 auto;">
            <canvas id="game-canvas" width="400" height="500" style="border:4px solid var(--primary);"></canvas>
            <div id="game-score" style="position:absolute; top:10px; left:10px; font-size:1.5rem; font-weight:bold; color:var(--primary);">Score: 0</div>
            <button id="start-game-btn" onclick="startGame()" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); padding:15px 30px; background:var(--accent); color:white; border:none; border-radius:50px; font-size:1.2rem; cursor:pointer; box-shadow:0 5px 15px rgba(0,0,0,0.2);">é–‹å§‹éŠæˆ²</button>
        </div>
    </div>

    <!-- APP 3: 3D MEMORY CUBE (ç›¸ç°¿) -->
    <div id="app-cube" class="app-card">
        <h2 style="text-align:center; color:var(--primary);">ğŸ§Š å›æ†¶é­”æ–¹</h2>
        <p style="text-align:center; color:#888;">é€™æ˜¯æˆ‘å€‘å¤šé¢çš„å›æ†¶ (æœƒè‡ªå‹•æ—‹è½‰)</p>
        
        <div class="cube-scene">
            <div class="cube">
                <!-- è«‹æ›¿æ›ç‚ºçœŸå¯¦ç…§ç‰‡ -->
                <div class="cube-face face-front"><img src="photo1.jpg" onerror="this.src='https://placehold.co/200x200/aed581/fff?text=Love'"></div>
                <div class="cube-face face-back"><img src="photo2.jpg" onerror="this.src='https://placehold.co/200x200/ffcc80/fff?text=You'"></div>
                <div class="cube-face face-right"><img src="photo3.jpg" onerror="this.src='https://placehold.co/200x200/81d4fa/fff?text=Cute'"></div>
                <div class="cube-face face-left"><img src="photo4.jpg" onerror="this.src='https://placehold.co/200x200/f48fb1/fff?text=Sweet'"></div>
                <div class="cube-face face-top"><img src="photo6.jpg" onerror="this.src='https://placehold.co/200x200/ce93d8/fff?text=Us'"></div>
                <div class="cube-face face-bottom" style="background:var(--primary); color:white;">Koala<br>Love</div>
            </div>
        </div>
    </div>

    <!-- APP 4: CLOUD CANVAS (ç•«å¸ƒ) -->
    <div id="app-draw" class="app-card">
        <h2 style="text-align:center; color:var(--primary);">ğŸ¨ é›²ç«¯å¡—é´‰ç‰†</h2>
        <div style="display:flex; gap:10px; justify-content:center; margin-bottom:10px;">
            <button onclick="setColor('#000')" style="width:30px; height:30px; background:#000; border-radius:50%; border:none;"></button>
            <button onclick="setColor('#e91e63')" style="width:30px; height:30px; background:#e91e63; border-radius:50%; border:none;"></button>
            <button onclick="setColor('#558b2f')" style="width:30px; height:30px; background:#558b2f; border-radius:50%; border:none;"></button>
            <button onclick="clearCanvas()" style="padding:5px 15px; border-radius:20px; border:1px solid #ccc; background:white;">æ¸…é™¤</button>
        </div>
        <canvas id="draw-canvas" width="600" height="400" style="border:2px dashed #ccc; background:white; cursor: url('data:image/svg+xml;utf8,<svg width=\'10\' height=\'10\' viewBox=\'0 0 10 10\' xmlns=\'http://www.w3.org/2000/svg\'><circle cx=\'5\' cy=\'5\' r=\'4\' fill=\'%23333\'/></svg>') 5 5, auto;"></canvas>
    </div>

</div> <!-- End App Container -->

<!-- åº•éƒ¨ Dock é¸å–® -->
<div class="dock-wrapper">
    <div class="dock-item active" onclick="switchApp('app-pet')">
        <i class="fas fa-paw"></i>
        <div class="dock-tooltip">é›»å­é›</div>
    </div>
    <div class="dock-item" onclick="switchApp('app-game')">
        <i class="fas fa-gamepad"></i>
        <div class="dock-tooltip">å°éŠæˆ²</div>
    </div>
    <div class="dock-item" onclick="switchApp('app-cube')">
        <i class="fas fa-cube"></i>
        <div class="dock-tooltip">å›æ†¶é­”æ–¹</div>
    </div>
    <div class="dock-item" onclick="switchApp('app-draw')">
        <i class="fas fa-palette"></i>
        <div class="dock-tooltip">å¡—é´‰ç‰†</div>
    </div>
</div>

<!-- éŸ³æ¨‚æ’­æ”¾ (éš±è—) -->
<audio id="bg-music" loop>
    <source src="ä½ çŸ¥é“ä½ æ¯”æ™šéœå¥½çœ‹å— - Tr33 (youtube).mp3" type="audio/mpeg">
</audio>
<script>
    /* =========================================
       1. SYSTEM BOOT
    ========================================= */
    window.addEventListener('load', () => {
        const loader = document.getElementById('sys-loader');
        setTimeout(() => {
            loader.style.transform = 'translateY(-100%)';
            initStarBg(); // å•Ÿå‹•èƒŒæ™¯
            // å˜—è©¦æ’­æ”¾éŸ³æ¨‚
            document.getElementById('bg-music').volume = 0.5;
            document.body.addEventListener('click', () => {
                document.getElementById('bg-music').play().catch(()=>{});
            }, {once:true});
        }, 1500);
    });

    /* =========================================
       2. APP SWITCHER (DOCK)
    ========================================= */
    function switchApp(appId) {
        // éš±è—æ‰€æœ‰ App
        document.querySelectorAll('.app-card').forEach(el => {
            el.classList.remove('active');
        });
        // é¡¯ç¤ºç›®æ¨™ App
        document.getElementById(appId).classList.add('active');
        
        // æ›´æ–° Dock ç‹€æ…‹
        document.querySelectorAll('.dock-item').forEach(el => {
            el.classList.remove('active');
        });
        event.currentTarget.classList.add('active');
    }

    /* =========================================
       3. SMART TIMER (2025-10-07)
    ========================================= */
    function updateTimer() {
        const target = new Date(2025, 9, 7, 0, 53, 0);
        const now = new Date();
        let diff = target - now;
        const label = document.getElementById('main-timer');

        if (diff > 0) {
            // å€’æ•¸
            const d = Math.floor(diff / (1000 * 60 * 60 * 24));
            const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const m = Math.floor((diff / (1000 * 60)) % 60);
            const s = Math.floor((diff / 1000) % 60);
            label.innerText = `è·é›¢ç´„å®šé‚„æœ‰ ${d}å¤© ${h}æ™‚ ${m}åˆ† ${s}ç§’`;
        } else {
            // ç´¯è¨ˆ
            diff = Math.abs(diff);
            const d = Math.floor(diff / (1000 * 60 * 60 * 24));
            label.innerText = `æˆ‘å€‘å·²ç¶“åœ¨ä¸€èµ· ${d} å¤©äº†`;
        }
    }
    setInterval(updateTimer, 1000);
    updateTimer();

    /* =========================================
       4. TAMAGOTCHI LOGIC (é›»å­é›)
    ========================================= */
    let hunger = 80;
    let happy = 80;
    
    function updatePetUI() {
        document.getElementById('bar-hunger').style.width = hunger + '%';
        document.getElementById('bar-happy').style.width = happy + '%';
        
        // ç‹€æ…‹é¡è‰²è®ŠåŒ–
        document.getElementById('bar-hunger').style.background = hunger < 30 ? '#ef5350' : '#ffca28';
        document.getElementById('bar-happy').style.background = happy < 30 ? '#ef5350' : '#ec407a';
    }

    function petSay(msg) {
        const dialog = document.getElementById('pet-dialog');
        dialog.innerText = msg;
        dialog.style.animation = 'pulse 0.5s';
        setTimeout(() => dialog.style.animation = '', 500);
    }

    function feedPet() {
        hunger = Math.min(100, hunger + 15);
        updatePetUI();
        petSay("åš¼åš¼åš¼... å°¤åŠ åˆ©è‘‰çœŸå¥½åƒï¼ğŸŒ¿");
        const pet = document.getElementById('koala-pet');
        pet.classList.add('eating');
        setTimeout(() => pet.classList.remove('eating'), 1000);
    }

    function playPet() {
        happy = Math.min(100, happy + 15);
        hunger = Math.max(0, hunger - 5); // ç©è€æœƒé¤“
        updatePetUI();
        petSay("å¥½é–‹å¿ƒï¼æœ€å–œæ­¡ç‘„æŸ”äº†ï¼â¤");
        const pet = document.getElementById('koala-pet');
        pet.classList.add('happy');
        setTimeout(() => pet.classList.remove('happy'), 1000);
    }

    function sleepPet() {
        petSay("å‘¼... å‘¼... æ™šå®‰... ğŸ’¤");
        const pet = document.getElementById('koala-pet');
        pet.classList.add('sleeping');
        setTimeout(() => pet.classList.remove('sleeping'), 3000);
    }

    // éš¨æ©Ÿè‡ªç„¶æ¶ˆè€—
    setInterval(() => {
        hunger = Math.max(0, hunger - 1);
        happy = Math.max(0, happy - 1);
        updatePetUI();
        if(hunger < 20) petSay("æˆ‘è‚šå­é¤“äº†...");
    }, 5000);
</script>
<script>
    /* =========================================
       5. GAME ENGINE (KOALA CATCH)
    ========================================= */
    const gCanvas = document.getElementById('game-canvas');
    const gCtx = gCanvas.getContext('2d');
    let gameRunning = false;
    let score = 0;
    let playerX = 175; // 400/2 - 25
    let items = [];
    let gameLoopId;

    // ç©å®¶æ§åˆ¶
    gCanvas.addEventListener('mousemove', (e) => {
        const rect = gCanvas.getBoundingClientRect();
        playerX = e.clientX - rect.left - 25;
    });
    // æ‰‹æ©Ÿè§¸æ§
    gCanvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        const rect = gCanvas.getBoundingClientRect();
        playerX = e.touches[0].clientX - rect.left - 25;
    });

    function startGame() {
        if(gameRunning) return;
        gameRunning = true;
        score = 0;
        items = [];
        document.getElementById('start-game-btn').style.display = 'none';
        gameLoop();
    }

    function gameLoop() {
        if(!gameRunning) return;
        
        // æ¸…ç©ºç•«å¸ƒ
        gCtx.clearRect(0, 0, 400, 500);
        
        // ç”¢ç”Ÿæ‰è½ç‰© (æ„›å¿ƒ)
        if(Math.random() < 0.03) {
            items.push({x: Math.random() * 380, y: 0, speed: Math.random() * 2 + 2});
        }

        // ç¹ªè£½ç©å®¶ (ç°¡å–®ç„¡å°¾ç†Šæ–¹å¡Š)
        gCtx.fillStyle = '#9e9e9e';
        gCtx.beginPath();
        gCtx.arc(playerX + 25, 460, 25, 0, Math.PI*2); // é ­
        gCtx.fill();
        gCtx.fillStyle = '#333'; // çœ¼
        gCtx.beginPath(); gCtx.arc(playerX + 15, 455, 3, 0, Math.PI*2); gCtx.fill();
        gCtx.beginPath(); gCtx.arc(playerX + 35, 455, 3, 0, Math.PI*2); gCtx.fill();
        gCtx.fillStyle = '#424242'; // é¼»
        gCtx.beginPath(); gCtx.ellipse(playerX + 25, 465, 6, 4, 0, 0, Math.PI*2); gCtx.fill();

        // æ›´æ–°æ‰è½ç‰©
        for(let i=0; i<items.length; i++) {
            let item = items[i];
            item.y += item.speed;
            
            // ç¹ªè£½æ„›å¿ƒ
            gCtx.fillStyle = '#e91e63';
            gCtx.font = '20px Arial';
            gCtx.fillText('â¤', item.x, item.y);

            // ç¢°æ’æª¢æ¸¬
            if(item.y > 440 && item.y < 480 && item.x > playerX && item.x < playerX + 50) {
                score++;
                document.getElementById('game-score').innerText = 'Score: ' + score;
                items.splice(i, 1);
                i--;
            } else if (item.y > 500) {
                items.splice(i, 1);
                i--;
            }
        }

        gameLoopId = requestAnimationFrame(gameLoop);
    }

    /* =========================================
       6. DRAWING BOARD (CANVAS)
    ========================================= */
    const dCanvas = document.getElementById('draw-canvas');
    const dCtx = dCanvas.getContext('2d');
    let painting = false;
    let drawColor = '#000';

    function startPosition(e) {
        painting = true;
        draw(e);
    }
    function endPosition() {
        painting = false;
        dCtx.beginPath();
    }
    function draw(e) {
        if (!painting) return;
        const rect = dCanvas.getBoundingClientRect();
        // æ”¯æ´æ»‘é¼ èˆ‡è§¸æ§
        const clientX = e.clientX || e.touches[0].clientX;
        const clientY = e.clientY || e.touches[0].clientY;
        
        dCtx.lineWidth = 5;
        dCtx.lineCap = 'round';
        dCtx.strokeStyle = drawColor;

        dCtx.lineTo(clientX - rect.left, clientY - rect.top);
        dCtx.stroke();
        dCtx.beginPath();
        dCtx.moveTo(clientX - rect.left, clientY - rect.top);
    }

    dCanvas.addEventListener('mousedown', startPosition);
    dCanvas.addEventListener('mouseup', endPosition);
    dCanvas.addEventListener('mousemove', draw);
    
    dCanvas.addEventListener('touchstart', (e)=>{e.preventDefault(); startPosition(e)});
    dCanvas.addEventListener('touchend', endPosition);
    dCanvas.addEventListener('touchmove', (e)=>{e.preventDefault(); draw(e)});

    function setColor(c) { drawColor = c; }
    function clearCanvas() { dCtx.clearRect(0, 0, dCanvas.width, dCanvas.height); }

    /* =========================================
       7. BACKGROUND ANIMATION (STARS)
    ========================================= */
    function initStarBg() {
        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const stars = [];
        for(let i=0; i<100; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2,
                speed: Math.random() * 0.5
            });
        }

        function animateBg() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            
            stars.forEach(star => {
                star.y += star.speed;
                if(star.y > canvas.height) star.y = 0;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI*2);
                ctx.fill();
            });
            requestAnimationFrame(animateBg);
        }
        animateBg();
    }
</script>
</body>
</html>
